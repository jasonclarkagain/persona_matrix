<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PERSONA MATRIX | CONTROL</title>
    <style>
        body { background: #050505; color: #00ff88; font-family: 'Courier New', monospace; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .glass-card { padding: 30px; border: 1px solid #00d4ff; border-radius: 12px; background: rgba(0, 212, 255, 0.05); backdrop-filter: blur(10px); width: 500px; text-align: center; }
        .btn-group { margin-top: 20px; display: flex; gap: 10px; justify-content: center; }
        button { background: transparent; border: 1px solid #00ff88; color: #00ff88; padding: 10px; cursor: pointer; text-transform: uppercase; }
        button:hover { background: #00ff88; color: #000; }
        .panic-btn { border-color: #ff4444; color: #ff4444; margin-top: 30px; width: 100%; }
        .panic-btn:hover { background: #ff4444; color: #fff; }
        .val { color: #ffffff; font-weight: bold; }
    </style>
</head>
<body>
    <div class="glass-card">
        <h1>MATRIX ACTIVE</h1>
        <div>PERSONA: <span id="persona" class="val">...</span></div>
        <div>STABILITY: <span id="stability" class="val">...</span></div>
        
        <div class="btn-group">
            <button onclick="setPersona('Old Man Yeller', 'Aggressive')">Aggressive</button>
            <button onclick="setPersona('Silent Observer', 'Stealth')">Stealth</button>
        </div>

        <button class="panic-btn" onclick="triggerPanic()">⚠️ EMERGENCY WIPE</button>
    </div>

    <script>
        async function triggerPanic() {
            if (confirm("INITIATE TOTAL WIPE? This will halt all processes and purge logs.")) {
                await fetch('/api/panic', { method: 'POST' });
                window.location.reload();
            }
        }

        async function setPersona(name, mode) {
            await fetch('/api/switch', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, mode })
            });
            update();
        }

        async function update() {
            const res = await fetch('/api/stats');
            const data = await res.json();
            document.getElementById('persona').innerText = data.active_persona;
            document.getElementById('stability').innerText = (data.stability * 100).toFixed(2) + '%';
        }
        setInterval(update, 2000);
        update();
    </script>
</body>
</html>
